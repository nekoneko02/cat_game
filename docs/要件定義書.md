# 要件定義書

この文書では、「たぬきねこ」ゲームの要件を定義する。

## プロジェクト概要

### 目的
ペットを飼えない人々に癒しと疑似飼育体験を提供するバーチャル猫ゲーム

### 対象ユーザー
- ペットを飼いたいが飼えない人
- 癒しを求める人
- 動物好きの人

### スコープ1の機能
- おもちゃで遊ぶ
- 愛でる（一緒に過ごす）
- なつき度システム
- ねこAI（学習機能）
- 基本的なねこアクション

## システム一覧

- ゲーム本体：ユーザーがログイン、プレイし、ねこと過ごすゲーム
- ねこ学習機能：ねこが、実際にユーザーと過ごした記録に基づき、学習をする機能
- ねこ作成機能：新しいねこのモデルを作成する機能

## ゲーム本体

### ゲーム全体像

1. ゲームを開始する
   1. （ゲームをインストールする）
   2. アカウントを作成する
   3. ログインをする
   4. ねこと家族になる
2. ゲームをプレイする
   1. ホーム画面
   2. 各ユーザーアクション
   3. ねことお別れする
3. ゲームを終了する
   1. アカウントを削除する
   2. （ゲームをアンインストールする）

### アクション一覧

#### ユーザーアクション

- 遊ぶ
- 開始する
- おもちゃを選ぶ
- おもちゃを動かす/動かさない
- 終了する
- エサやり
- 開始する
- エサの種類と量を選ぶ
- エサをあげる
- 終了する
- なでる
- 開始する
- 触れる/触れない
- 手を動かす/動かさない
- 終了する
- 愛でる（一緒に過ごす）
- 開始する
- 移動する（ねこに近づく等）
- 終了する
- 声かけ/叱る
-

### エサやり

- ユーザーは、エサを選択してねこにあげることができる
- エサの種類：通常のエサ、おやつ
- エサをあげる際は、任意の場所に配置する
- ねこは好みに応じてエサを食べる/食べないを判断
- エサを食べるとなつき度が上がる
- ねこはエサの好みを持つ（スコープ2以降で詳細実装）

### なでる

- ユーザーは、ねこをなでることができる
- マウス操作でねこに触れる
- ねこは、なつき度や現在の状態に応じて反応する
- ポジティブな反応の場合、なつき度が上がる
- ネガティブな反応の場合、なつき度に影響しない、または下がる

### 愛でる（一緒に過ごす）

- デフォルトのホーム画面状態
- ユーザーはアバターを操作してねこの近くにいることができる
- ねこはユーザーの位置、なつき度に応じて行動を変える
- 一緒に過ごす時間に応じてなつき度が徐々に上がる
- ねこは学習により、ユーザーの行動パターンに適応する

### 声かけ・叱る

- ユーザーはねこに声をかけることができる
- 声かけの種類：呼びかけ、褒める、叱る
- ねこは声かけの種類となつき度に応じて反応する
- 適切な声かけはなつき度を向上させる

### おもちゃを選ぶ

- ユーザーは、遊ぶ際に使用するおもちゃを選択する。
- おもちゃは以下の属性を持ち、ねこはそれぞれの好みを持つ
  - 見た目
  - 素材
  - 音
- 好みが合うおもちゃほど、ねこは遊びやすくなる
- おもちゃの属性・ねこの好みは固定である

### おもちゃを動かす/動かさない

- ユーザーはおもちゃを動かす
- マウス・クリック操作などの連続的な操作性を想定
- ねこは、おもちゃの動かし方に対する好みを持つ
- なつき度、おもちゃの属性・動かし方とねこの好みに従い、ねこはじゃれるかどうかを決定する
- ねこが取るアクションに従い、適切なアニメーション、ねこの位置移動が行われる
- ねこがポジティブ/ニュートラルな行動を取るとなつき度が上がる

## ねこアクション

### 共通

- なつき度が一定以上だと、必ずポジティブな行動をとる
- なつき度が一定以下だと、必ずネガティブな行動をとる
- それ以外だと、確率に従い、アクションを選択する
- また、遊ぶときは、じゃれるアクションを取りやすくなるなど、状況に応じて取るアクションの確率が変化する
  - ユーザーアクション
  - ねこの内部状態
  - ねこの好み

### 遊ぶ

#### 影響を受けるアクション

- 近づく
- おもちゃにじゃれる

#### 好み

- 速さ
- 動きの方向
- ランダム性
- おもちゃの属性
  - 音
  - 素材
  - 色
  - 見た目

## ねこAIシステム

### 感情変数システム

- **快適度（Valence）**: ねこの気分の良さ（-1: 不快 ～ 1: 快適）
- **覚醒度（Arousal）**: ねこの活動レベル（-1: 眠い ～ 1: 元気）
- **安全安心度（Safety/Trust）**: 環境への安心感（-1: 不安 ～ 1: 安心）
- **親和性（Social）**: ユーザーとの親密度（-1: 嫌悪 ～ 1: 親愛）
- **身体的不快度（Discomfort）**: 体調の悪さ（-1: 不調 ～ 1: 健康）

### 内部状態変数

- **空腹度**: エサやりの必要性を決定
- **喉の渇き**: 水を飲む行動に影響
- **疲労度**: 活動性に影響
- **眠気**: 休息の必要性
- **健康度**: 全体的な体調
- **排泄欲求**: トイレ行動の誘発
- **なつき度**: ユーザーに対する親密度（スコープ1の重要指標）
- **不安度**: 環境への反応
- **好奇心**: 新しいものへの興味
- **遊びたい気分**: 活動欲求（スコープ1）
- **恐怖**: 危険回避行動（スコープ1）

### 性格システム

- **社交的/孤独好き**: 人との接触の好み
- **活発/のんびり**: 活動レベルの傾向
- **臆病/大胆**: 新しい刺激への反応
- **甘えん坊/独立型**: ユーザーへの依存度
- **人懐っこさ**: 人への親しみやすさ
- **食の好み**: エサの選択に影響（スコープ2以降で詳細化）
- **おもちゃの好み**: 遊びの選択に影響

### 学習メカニズム

- ユーザーアクションとねこの反応を記録
- なつき度、時間、状況に応じて行動確率を調整
- ユーザーの離脱パターンを学習し、行動を適応
- セッション毎にねこの行動パターンが進化

### ステップ1でのスコープ
全て-1~1の値とする

- 内部状態
  - なつき度：ねこアクションがお腹見せorおもちゃにじゃれる => +
  - 遊びたい度：ねこアクションがおもちゃにじゃれる => -
  - 恐怖：ユーザと過ごすと+, ねこアクションがお腹見せorおもちゃにじゃれると => +
- 感情
  - 快：なつき度と恐怖の平均
  - 覚醒：遊びたい度と一致
  - 安心：なつき度と恐怖の平均
  - 親和：なつき度と一致
  - 身体的不快：0固定
- ねこアクション（各値のソフトマックスに従った確率によって、アクションを選択する）
  - お腹見せ：快、安心、親和の平均
  - おもちゃにじゃれる・追いかける：覚醒と一致
  - お座り：0
  - 逃げる・隠れる：快と安心の平均のマイナス1倍
